{"componentChunkName":"component---src-templates-markdown-js","path":"/operators/continuous-deployment/docs/downstream/odh-install-crc.md","result":{"data":{"site":{"siteMetadata":{"title":"Operate First"}},"markdownRemark":{"id":"9b7127af-0090-55f5-b128-c72f4aca73a1","html":"<h1>Installing ODH using ArgoCD</h1>\n<h2>Preparation</h2>\n<p>First make sure that you have the OpenDataHub operator available in your OpenShift.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc get packagemanifests -n openshift-marketplace <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> opendatahub-operator</code></pre></div>\n<p>If it’s not present, then you need to troubleshoot the marketplace: <a href=\"https://github.com/operator-framework/operator-marketplace/issues/344\">https://github.com/operator-framework/operator-marketplace/issues/344</a></p>\n<p>Then we need to create a projects named <code class=\"language-text\">odh-operator</code> and <code class=\"language-text\">opf-*</code>. (The name of the project is hard-coded in the <code class=\"language-text\">kustomize</code> files in <a href=\"https://github.com/operate-first/odh\">https://github.com/operate-first/odh</a> and you can change is there using <code class=\"language-text\">kustomize</code>.)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc new-project odh-operator\noc new-project opf-<span class=\"token punctuation\">{</span>jupyterhub,superset<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Our ArgoCD SA <code class=\"language-text\">argocd-manager</code> needs to have access to the new project. On CRC I suggest giving <code class=\"language-text\">argocd-manager</code> access to all projects by creating a ClusterRoleBinding to a ClusterRole.</p>\n<p><code class=\"language-text\">oc apply -f examples/argocd-cluster-binding.yaml</code></p>\n<p>Then you need to change the <code class=\"language-text\">dev-cluster</code> to include all projects/namespace. (This is done by actually removing the value of <code class=\"language-text\">namespace</code>).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc patch secret dev-cluster-spec -n aicoe-argocd-dev --type<span class=\"token operator\">=</span><span class=\"token string\">'json'</span> -p<span class=\"token operator\">=</span><span class=\"token string\">\"[{'op': 'replace', 'path': '/data/namespaces', 'value':''}]\"</span></code></pre></div>\n<p>Be aware that if you change this value in the ArgoCD UI, you might loose the stored credentials for the cluster due to a bug in ArgoCD.</p>\n<h2>Creating the ArgoCD applications</h2>\n<p>Now we can proceed with creating the ArgoCD Applications. We will create 2 applications:</p>\n<ol class=\"pf-c-list\">\n<li>The ODH operator. (Installs the ODH operator itself <code class=\"language-text\">odh-operator</code>.)</li>\n<li>The ODH deployment. (Installs ODH components into <code class=\"language-text\">opf-*</code>.)</li>\n</ol>\n<h3>Creating the ODH operator</h3>\n<p>You can create the Application resource from the command line using</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc apply -f examples/odh-operator-app.yaml</code></pre></div>\n<p>Or you can go to <a href=\"https://argocd-server-aicoe-argocd-dev.apps-crc.testing/applications\">https://argocd-server-aicoe-argocd-dev.apps-crc.testing/applications</a> and click “New App” and entering these values:</p>\n<table class=\"pf-c-table\">\n<thead>\n<tr>\n<th>Field</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Project:</td>\n<td>Default</td>\n</tr>\n<tr>\n<td>Cluster:</td>\n<td>dev-cluster (<a href=\"https://api.crc.testing.6443\">https://api.crc.testing.6443</a>)</td>\n</tr>\n<tr>\n<td>Namespace:</td>\n<td>odh-operator</td>\n</tr>\n<tr>\n<td>Repo URL:</td>\n<td><a href=\"https://github.com/operate-first/odh.git\">https://github.com/operate-first/odh.git</a></td>\n</tr>\n<tr>\n<td>Target revision:</td>\n<td>HEAD</td>\n</tr>\n<tr>\n<td>Path:</td>\n<td>operator/base</td>\n</tr>\n</tbody>\n</table>\n<p>This creates an app from definition in the repo under the path <code class=\"language-text\">odh-operator/base</code> and deploys it to the <code class=\"language-text\">odh-operator</code> namespace on the <code class=\"language-text\">dev-cluster</code>.</p>\n<p>This app is all about deploying the Open Data Hub operator to your cluster.</p>\n<p>Please note that the namespace is also hard-coded in the repo so changing it requires changing files in the repo.</p>\n<p>Create the app and you will see Argo deploying resources:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/operate-first.github.io/static/f7abffec7cc29853f46c01d5464a0735/8cae4/odh-operator.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.24324324324324%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABcklEQVQoz0WQ2VLCMBSG++oqKi0II/hM3njjII4CXaxNk2ZfCgiKrSdUNHMm8/UsOf/fIByOhjeji97ldb8fRoMwjOCOAI4MqV7v8uz8Yjy+HUwnk7vpdTi86kfj22k0GAX388VskQizThB5WqYQs2X6+BLPl+lznM1X2WyR7vafbds27e/ZfX2b3cF9N8E7pdbVbdPkUi5LbG3NrH3ERaWU1FYZa1z9dTi0/6eB5o4CIg03NVUWAHGFhamULZgsmCqoLLmGT5+Utjr2QGChIUO1DRY5SUq+KmhcMgjg5HgfmaWYd3loyIggwhChYRPiOsUseH0rM8JhD2Iqr+Qb4fAwU5Zp985Uhpln6eVAFXNVenU6wzwnPHh4jp+yQrh6vd1X2sWowlLVm63bbPNKxAVx683Hbg/WMiywNLCWGweb/XCMvJ5OaoJ5J7WgXkWMWFoy8A8OU1/iOZWIShiDEoj6H4byX3TOT8z+/J/+iOcVoj8hadYhToEPzAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ODH operator\"\n        title=\"ODH operator\"\n        src=\"/operate-first.github.io/static/f7abffec7cc29853f46c01d5464a0735/fcda8/odh-operator.png\"\n        srcset=\"/operate-first.github.io/static/f7abffec7cc29853f46c01d5464a0735/12f09/odh-operator.png 148w,\n/operate-first.github.io/static/f7abffec7cc29853f46c01d5464a0735/e4a3f/odh-operator.png 295w,\n/operate-first.github.io/static/f7abffec7cc29853f46c01d5464a0735/fcda8/odh-operator.png 590w,\n/operate-first.github.io/static/f7abffec7cc29853f46c01d5464a0735/efc66/odh-operator.png 885w,\n/operate-first.github.io/static/f7abffec7cc29853f46c01d5464a0735/8cae4/odh-operator.png 1109w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Creating the ODH deployment</h3>\n<p>Again, either from the command line:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">oc apply -f examples/odh-deployment-app.yaml</code></pre></div>\n<p>or again going to <a href=\"https://argocd-server-aicoe-argocd-dev.apps-crc.testing/applications\">https://argocd-server-aicoe-argocd-dev.apps-crc.testing/applications</a>, clicking “New App” and entering these values:</p>\n<table class=\"pf-c-table\">\n<thead>\n<tr>\n<th>Field</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Project:</td>\n<td>Default</td>\n</tr>\n<tr>\n<td>Cluster:</td>\n<td>dev-cluster (<a href=\"https://api.crc.testing.6443\">https://api.crc.testing.6443</a>)</td>\n</tr>\n<tr>\n<td>Namespace:</td>\n<td>opf-jupyterhub</td>\n</tr>\n<tr>\n<td>Repo URL:</td>\n<td><a href=\"https://github.com/operate-first/odh.git\">https://github.com/operate-first/odh.git</a></td>\n</tr>\n<tr>\n<td>Target revision:</td>\n<td>HEAD</td>\n</tr>\n<tr>\n<td>Path:</td>\n<td>kfdef/jupyterhub</td>\n</tr>\n</tbody>\n</table>\n<table class=\"pf-c-table\">\n<thead>\n<tr>\n<th>Field</th>\n<th>Value</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Project:</td>\n<td>Default</td>\n</tr>\n<tr>\n<td>Cluster:</td>\n<td>dev-cluster (<a href=\"https://api.crc.testing.6443\">https://api.crc.testing.6443</a>)</td>\n</tr>\n<tr>\n<td>Namespace:</td>\n<td>opf-superset</td>\n</tr>\n<tr>\n<td>Repo URL:</td>\n<td><a href=\"https://github.com/operate-first/odh.git\">https://github.com/operate-first/odh.git</a></td>\n</tr>\n<tr>\n<td>Target revision:</td>\n<td>HEAD</td>\n</tr>\n<tr>\n<td>Path:</td>\n<td>kfdef/superset</td>\n</tr>\n</tbody>\n</table>\n<p>This is about the actual deployment of Open Data Hub to your cluster.</p>\n<p>Based on the content of <code class=\"language-text\">kfdef.yaml</code> (you will see components of ODH being created similar to:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/operate-first.github.io/static/12cee511a47d5955948e2ed6b1e4432c/b6e34/odh-deployment.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.75675675675676%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB20lEQVQoz21RyXKbQBTkc517DilJFUcVJ9+haDFS2Y5tJb8RVw6JIxsjtmGYnWEZQMIReZTKOXmqgQfz+k13Y705OZmtrqazxXQ6X9qrc3u5gMte2efLhb2EcjZfTCZfLi4ur2/WX7+vb9ffJnN7urq8ur61Pp+NfzjeFiXlrv0Tol+Ot/Gin65397h98JEb4Xs3RJR3XXc4HLqXBdXfrrPeDoZZVRlTN/u9xwUSylR1oJQvhNR5qousMIWpmma3b9v2uV/9s32GV2swHNG0iJgCIJbCPaQSUeWEZIu5n4iYq0RqojLEFVOZzsvS1DIr4Ls1GL0PqHJj9vQC4DxG5N7HLuYBkUIXaV6mhdkmPGYKahDCswLarHeD4d1DsImwyorM1FhqN6ZEal0Y6HAQRVQAISsrjwg/4dDW7FrYCojoyW7MXcwiqgA+kR6oJQK0eLhXAS5ikWKeegm44BGTMU+BGVHZyw4ZnMaOgG4AFL+9GIY+IRoSIXSuywrmgqhEQIiGpDkMtUanH46ej7T/2ATYiaiHBdg+BrnFDPJDTCVCh0T25NPxx1fJDyEBw3Ay5qqs6nrfhky5iELguWkg/N7z+OzTq2RgOhEBYC7LuqmaXdDLZsf/ArvQ8w/N3j5C4fvg/AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ODH operator\"\n        title=\"ODH operator\"\n        src=\"/operate-first.github.io/static/12cee511a47d5955948e2ed6b1e4432c/fcda8/odh-deployment.png\"\n        srcset=\"/operate-first.github.io/static/12cee511a47d5955948e2ed6b1e4432c/12f09/odh-deployment.png 148w,\n/operate-first.github.io/static/12cee511a47d5955948e2ed6b1e4432c/e4a3f/odh-deployment.png 295w,\n/operate-first.github.io/static/12cee511a47d5955948e2ed6b1e4432c/fcda8/odh-deployment.png 590w,\n/operate-first.github.io/static/12cee511a47d5955948e2ed6b1e4432c/efc66/odh-deployment.png 885w,\n/operate-first.github.io/static/12cee511a47d5955948e2ed6b1e4432c/b6e34/odh-deployment.png 1103w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>You can find routes for your new ODH instance by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ oc get routes -n opf-jupyterhub\nNAME         HOST/PORT                                               <span class=\"token environment constant\">PATH</span>   SERVICES     PORT       TERMINATION     WILDCARD\njupyterhub   jupyterhub-opf-jupyterhub.apps-crc.testing          jupyterhub   <span class=\"token number\">8080</span>-tcp   edge/Redirect   None\n\n$ oc get routes -n opf-superset\nNAME         HOST/PORT                                               <span class=\"token environment constant\">PATH</span>   SERVICES     PORT       TERMINATION     WILDCARD\nsuperset     superset-opf-superset.apps-crc.testing              superset     <span class=\"token number\">8088</span>-tcp                   None</code></pre></div>\n<p>To alter components deployed or anything else about the configuration fork <a href=\"https://github.com/operate-first/odh\">https://github.com/operate-first/odh</a> and replace references to this repo with your own fork.</p>","frontmatter":{"title":"","description":null}}},"pageContext":{"id":"9b7127af-0090-55f5-b128-c72f4aca73a1"}},"staticQueryHashes":["117426894","3000541721"]}